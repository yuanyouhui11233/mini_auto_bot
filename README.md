# 项目描述

> 本项目是一个基于 Python 的自动化工具，用于在某个时间段内抢购微信某小程序的商品。
> 模拟人工操作，实现自动抢购的功能。

# 功能

- 控制多个模拟器打开微信小程序
- 在搜索框内输入关键词
- 点击搜索按钮
- 点击加入购物车
- 购物车有商品时，进入购物车点击"去结算"按钮
- 结算页面点击按钮进行付款

# 项目结构

```
py-mini-bot/
├── README.md                 # 项目文档
├── requirements.txt          # 项目依赖
├── config/
│   ├── config.yaml          # 主配置文件
│   └── devices.yaml         # 设备配置文件
├── src/
│   ├── __init__.py
│   ├── core/               # 核心功能模块
│   │   ├── __init__.py
│   │   ├── device.py      # 设备控制
│   │   ├── scheduler.py   # 任务调度
│   │   └── automator.py   # 自动化操作
│   ├── utils/             # 工具函数
│   │   ├── __init__.py
│   │   ├── logger.py     # 日志工具
│   │   └── image.py      # 图像处理
│   └── tasks/            # 具体任务实现
│       ├── __init__.py
│       └── shopping.py   # 购物流程
├── assets/              # 资源文件
│   └── images/         # UI元素模板图片
│       ├── search_btn.png
│       ├── cart_btn.png
│       └── pay_btn.png
├── logs/               # 日志目录
└── tests/             # 测试用例
    ├── __init__.py
    └── test_automator.py
```

# 技术栈

- Python 3.x：核心开发语言
- ADB：安卓模拟器控制
- OpenCV/Airtest：图像识别和 UI 自动化
- PyYAML：配置管理
- APScheduler：定时任务调度

# 自动化流程

```
搜索阶段 -> 加购阶段 -> 结算阶段 -> 支付阶段
   ↑          ↑           ↑           ↑
图像识别    坐标点击    图像识别    坐标点击
```

- 使用 OpenCV 模板匹配来识别关键 UI 元素
- 对于固定位置的按钮，使用坐标点击提高效率
- 每个阶段设置超时机制，确保流程不会卡住

# GUI 界面设计

```
+------------------------+
|     状态监控面板       |
+------------------------+
|  设备1 | 设备2 | 设备3 |
+------------------------+
|     配置管理面板       |
|- 时间窗口设置         |
|- 关键词配置           |
|- 设备管理             |
+------------------------+
|     日志查看面板       |
+------------------------+
|     操作控制面板       |
+------------------------+
```

- 状态监控：实时显示每个设备的运行状态
- 配置管理：
  - 时间窗口设置：（开始时间、结束时间、检测间隔）
  - 关键词配置：设置要搜索的关键词
  - 设备连接配置
- 日志查看：实时显示运行日志，支持日志过滤
- 操作控制:
  - 启动/停止按钮
  - 测试按钮（用于测试单个设备的连接）
  - 紧急停止按钮

```
todo:
- 先实现配置管理，建立项目基础结构
- 实现设备控制模块，确保可以稳定控制模拟器
- 开发自动化操作模块，实现核心功能
- 最后添加GUI界面，提供更好的用户体验
```
